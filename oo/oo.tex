

\section{Simple Object Concepts}

\inputminted[fontsize=\scriptsize, fontsize=\scriptsize, lastline=8]{ocaml}{oo/code/simple.ml}


obj\#method, the actual method gets called is determined at runtime.


\inputminted[fontsize=\scriptsize, fontsize=\scriptsize, firstline=8,lastline=15]{ocaml}{oo/code/simple.ml}


.. is a row variable 
\inputminted[fontsize=\scriptsize, fontsize=\scriptsize, firstline=15,lastline=18]{ocaml}{oo/code/simple.ml}


\textbf{ \{<>\} }represents a \textbf{functional update} (only
fields), which produces a new object


Some other examples
\inputminted[fontsize=\scriptsize, fontsize=\scriptsize, firstline=18,lastline=67]{ocaml}{oo/code/simple.ml}


Something to Notice

Field expression \textbf{could not} refer to other fields, nor to
itself, after you get the object you can have initializer. The object
\textit{does not exist} when the field values are be computed. For the
initializer, you can call \verb|self#blabla|
\inputminted[fontsize=\scriptsize, fontsize=\scriptsize, firstline=66,lastline=80]{ocaml}{oo/code/simple.ml}


Private method
\inputminted[fontsize=\scriptsize, fontsize=\scriptsize, firstline=81,lastline=88]{ocaml}{oo/code/simple.ml}


Subtyping


Supports \textit{width and depth subtyping, contravariant and
  covariant} for subtyping of recursive object types, \textit{first
  assume it is right} then prove it using such assumption. Sometimes,
type annotation and coersion both needed, when t2 is recursive or t2
has polymorphic structure.

\begin{ocamlcode}
  e : t1 :> t2
\end{ocamlcode}


Simulate narrowing(downcast)

\inputminted[fontsize=\scriptsize, fontsize=\scriptsize, ]{ocaml}{oo/code/downcast.ml}

It's doable, since \verb|exn| is open and its tag is global, and you
can store the tag information uniformly. But onething to notice is
that you can not write safe code, since exn is extensible, you can not
guarantee that you match is exhuastive.

You can also implement using polymorphic variants, this is essentially
the same thing, since \verb|Polymorphic Variants| is also global and
extensible.


\inputminted[fontsize=\scriptsize, fontsize=\scriptsize, ]{ocaml}{oo/code/downcast2.ml}



\section{Modules vs Objects}

\begin{enumerate}
\item Objects (data entirely hidden)
\item Self recursive type is so natural in objects, isomorphic-like
  equivalence is free in oo.
\item Example

\inputminted[fontsize=\scriptsize, fontsize=\scriptsize, ]{ocaml}{oo/code/obj_module.ml}
\end{enumerate}


\section{More about class}
