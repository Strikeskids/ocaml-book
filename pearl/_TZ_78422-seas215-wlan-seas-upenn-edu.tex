\documentclass[svgnames,12pt,a4paper]{report}
\usepackage[latin9]{inputenc}
\usepackage[letterpaper]{geometry}
\geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{float}
\usepackage{array}
\usepackage{tikz}
\usepackage{enumerate}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{fancyvrb}
\usepackage{wasysym}
\usepackage[online]{suthesis-2e}
\usepackage{todonotes}
\usepackage{caption}
\usepackage{minted}


\usepackage{setspace}

\definecolor{MyDarkBlue}{rgb}{0,0.08,0.45}
\definecolor{lightgray}{rgb}{0.9,0.9,0.9}
\definecolor{lightlightgray}{rgb}{0.98,0.98,0.98}


%% begin listing configuration 
\lstset{
  basicstyle=\footnotesize\ttfamily,
  numberstyle=\tiny,
  % numbers=left,
  stepnumber=5,
  numbersep=5pt,
  tabsize=2,
  extendedchars=true,
  breaklines=true,
  keywordstyle=\color{blue}\bfseries, % to do
  stringstyle=\color{orange}\ttfamily, %to do
  identifierstyle=\color{teal},
  showstringspaces=true,
  showspaces=false,
  showtabs=false,
  % xleftmargin=17pt,
  framexrightmargin=5pt,
  framexbottommargin=4pt,
  % backgroundcolor=\color{lightgray}, % to do
  commentstyle=\color{red},% todo 
  % frame=lines,
  frame=bottom,
  backgroundcolor=\color{lightlightgray},
  framerule=1pt,
  % emph={square,root},
  % emphstyle=\underbar,
  %% language={[Objective]Caml},
}
\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{\colorbox[cmyk]{0.43, 0.35, 0.35,0.01}{\parbox{\textwidth}{\hspace{15pt}#1#2#3}}}
\captionsetup[lstlisting]{format=listing,labelfont=white,textfont=white, singlelinecheck=false, margin=0pt, font={bf,footnotesize}}

%% end


\makeatletter

\makeatother


% \newenvironment{ocamlcode}{\Verbatim[fomartcom=\color{blue}]}{\endVerbatim}
% New commands serve as shorthand for frequently used command combinations.
% \newcommand{\ind}[1]{\mathbf{1}\left(#1\right)}
% \newcommand{\bx}{\mathbf{x}}
% \newcommand{\E}{\mathbf{E}}
% \DefineVerbatimEnvironment{ocamlcode}{Verbatim}{formatcom=\color{red},fontsize=\scriptsize}
% \DefineVerbatimEnvironment{bluetext}{Verbatim}{formatcom=\color{MyDarkBlue},fontsize=\scriptsize}
% \DefineVerbatimEnvironment{ocamlcode}{Verbatim}{formatcom=\color{blue},fontsize=\scriptsize}
% \lstnewenvironment{ocamlcode}
% {\singlespacing}{}


\usepackage{etoolbox}

\setlength\partopsep{-\topsep}
\addtolength\partopsep{-\parskip}
\addtolength\partopsep{0.5cm}


%% \AtBeginEnvironment{minted}{\fontsize{10}{10}\selectfont}


%% \AtBeginEnvironment{bluetext}{\singlespacing%
%%     \fontsize{10}{10}\selectfont}


%% \AtBeginEnvironment{inputminted[fontsize=\scriptsize, ]}{\singlespacing%
%%     \fontsize{10}{10}\selectfont}


\newcommand{\ChangeLine}[1]{%
\ifodd\value{FancyVerbLine}%
\textcolor{red}{#1}\else\textcolor{blue}{#1}\fi}


\newminted{ocaml}{fontsize=\scriptsize}
%% \newinputminted[fontsize=\scriptsize, ]{ocaml}

%% \newminted[ocamlcode]{ocaml}{}
%% \newminted[ocamlcode]{ocaml}{}
%% \newminted[smallcode]{ocaml}{}
%% \newminted[ocamlcode]{ocaml}{frame=single,
%%  formatcom=\renewcommand{\FancyVerbFormatLine}{\ChangeLine}}


\lstnewenvironment{bluetext}
{\singlespacing\lstset{backgroundcolor=\color{lightgray}}}{}

\DefineVerbatimEnvironment{alternate}{Verbatim}%
{formatcom=\renewcommand{\FancyVerbFormatLine}{\ChangeLine},%
fontsize=\scriptsize,frame=lines}{}

% \def\dashfill{\cleaders\hbox{-}\hfill}
%% \includeonly{toolchain/ob}

\begin{document}


\section{Write Printf-Like Function With Ksprintf}


\inputminted[fontsize=\scriptsize,firstline=3,lastline=6]{ocaml}{pearl/code/simple.ml}


\section{Optimization}


\verb|let a,b = ... | allocates a tuple \verb|(a,b)| before discarding
it, rewriting as 
\end{document}
