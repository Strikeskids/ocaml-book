%%% master.tex --- 
%% \revision$Header: /Users/bob/SourceCode/Notes/ocaml-hacker.tex,v 0.0 2011/10/23 02:58:53 bob Exp$
\documentclass[svgnames,12pt,a4paper]{book}
\usepackage[latin9]{inputenc}
\usepackage[letterpaper]{geometry}
\geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{float}
\usepackage{array}
\usepackage{tikz}
\usepackage{longtable}
\usepackage{enumerate}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{fancyvrb}
\usepackage{wasysym}
\usepackage[online]{suthesis-2e}
\usepackage{todonotes}
\usepackage{caption}
\usepackage{minted}


\usepackage{setspace}

\definecolor{MyDarkBlue}{rgb}{0,0.08,0.45}
\definecolor{lightgray}{rgb}{0.9,0.9,0.9}
\definecolor{lightlightgray}{rgb}{0.95,0.95,0.95}


%% begin listing configuration 
\lstset{
  % basicstyle=\footnotesize\ttfamily,
  basicstyle=\scriptsize,
  numberstyle=\tiny,
  % numbers=left,
  stepnumber=5,
  numbersep=5pt,
  tabsize=2,
  extendedchars=true,
  breaklines=true,
  keywordstyle=\color{blue}\bfseries, % to do
  stringstyle=\color{orange}\ttfamily, %to do
  identifierstyle=\color{teal},
  showstringspaces=true,
  showspaces=false,
  showtabs=false,
  % xleftmargin=17pt,
  framexrightmargin=5pt,
  framexbottommargin=4pt,
  % backgroundcolor=\color{lightgray}, % to do
  commentstyle=\color{red},% todo 
  % frame=lines,
  frame=bottom,
  backgroundcolor=\color{lightlightgray},
  framerule=1pt,
  % emph={square,root},
  % emphstyle=\underbar,
  %% language={[Objective]Caml},
}
\DeclareCaptionFont{green}{\color{green}}
\DeclareCaptionFormat{listing}{\colorbox[cmyk]{0.43, 0.35,
    0.35,0.01}{\parbox{\textwidth}{\hspace{15pt}#1#2#3}}}

\captionsetup[lstlisting]{format=listing,labelfont=green,textfont=green, singlelinecheck=false, margin=0pt, font={bf,footnotesize}}

%% end


\makeatletter

\makeatother


% \newenvironment{ocamlcode}{\Verbatim[fomartcom=\color{blue}]}{\endVerbatim}
% New commands serve as shorthand for frequently used command combinations.
% \newcommand{\ind}[1]{\mathbf{1}\left(#1\right)}
% \newcommand{\bx}{\mathbf{x}}
% \newcommand{\E}{\mathbf{E}}
% \DefineVerbatimEnvironment{ocamlcode}{Verbatim}{formatcom=\color{red},fontsize=\scriptsize}
% \DefineVerbatimEnvironment{bluetext}{Verbatim}{formatcom=\color{MyDarkBlue},fontsize=\scriptsize}
% \DefineVerbatimEnvironment{ocamlcode}{Verbatim}{formatcom=\color{blue},fontsize=\scriptsize}
% \lstnewenvironment{ocamlcode}
% {\singlespacing}{}


\usepackage{etoolbox}

\setlength\partopsep{-\topsep}
\addtolength\partopsep{-\parskip}
\addtolength\partopsep{0.5cm}


%% \AtBeginEnvironment{minted}{\fontsize{10}{10}\selectfont}


%% \AtBeginEnvironment{bluetext}{\singlespacing%
%%     \fontsize{10}{10}\selectfont}


%% \AtBeginEnvironment{inputminted[fontsize=\scriptsize, ]}{\singlespacing%
%%     \fontsize{10}{10}\selectfont}


\newcommand{\ChangeLine}[1]{%
\ifodd\value{FancyVerbLine}%
\textcolor{red}{#1}\else\textcolor{blue}{#1}\fi}


\newminted{ocaml}
{fontsize=\scriptsize,bgcolor=lightlightgray,
  frame=lines, framesep=2mm, numbersep=5pt,
  linenos}
\newminted{bash}
{fontsize=\scriptsize,bgcolor=lightlightgray,
  frame=lines, framesep=2mm, numbersep=5pt,
  linenos}

\lstnewenvironment{bluetext}
{\singlespacing\lstset{backgroundcolor=\color{lightgray}}}{}

\DefineVerbatimEnvironment{alternate}{Verbatim}%
{formatcom=\renewcommand{\FancyVerbFormatLine}{\ChangeLine},%
fontsize=\scriptsize,frame=lines}{}






\begin{document}

\include{cover}
\setcounter{tocdepth}{4}


%% \title{OCaml Hacks}
%% \author{Hongbo Zhang}
%% \maketitle


\prefacesection{Preface}
\begin{quotation}
  \textit{This is a book about hacking in ocaml.  It's assumed that
    you already understand the underlying theory. Happy hacking Most
    parts are filled with code blocks, I will add some comments in the
    future. Still a book in progress. Don't distribute it.}

\smiley
\end{quotation}
\prefacesection{Acknowledgements}
\todo{write later}



\newpage

\tableofcontents
\listoftodos
\vspace*{1cm}

\newpage
\newpage 
\chapter{Tool Chain}
\include{toolchain/ob} 

\include{toolchain/godi}

\include{toolchain/ocamlfind}

\include{toolchain/toplevel}

\include{toolchain/ocamldoc}

\include{toolchain/ocamlmktop}

\include{toolchain/ocamlc}


% section svn
\include{svn/git}

\chapter{Lexing}
\include{lexing/lex}
\include{ocaml-lex}

\chapter{Parsing}
\label{sec:ocamlyacc}
\include{ocaml-yacc}


\chapter{Camlp4}
\label{sec:camlp4}
Camlp4 stands for Preprocess-Pretty-Printer for \verb|OCaml|, it's
extremely powerful and  hard to grasp as well. It is a
source-to-source level translation tool.
  \include{camlp4/intro}
  \include{camlp4/tutorial}
  \include{camlp4/explore}
  \include{camlp4/extensible_parser}
  \include{camlp4/stream_parser}
  \include{camlp4/gram}
  
  \include{camlp4/quotations}
  \include{camlp4/transform}
  \include{camlp4/jake_blog}
  \include{camlp4/revised_syntax}
  \include{camlp4/built_in_extension}
  \include{camlp4/examples}
  \include{camlp4/links}
  \include{camlp4/cheatsheet}

\chapter{Libraries}
\include{library/batteries}
\include{library/bolt}
\include{library/mikmatch}
\include{library/pa-do}
\include{library/num}
\include{library/caml-inspect}
\include{library/ocaml-graph}
\include{library/monad}
\include{library/bigarrary}
\include{library/sexplib}
\include{library/bin-prot}
\include{library/fieldslib}
\include{library/variantslib}
\include{library/delimcc}
\include{library/shcaml}
\include{library/deriving}


\section{Modules}
\include{module-lang}

\chapter{Runtime}
\label{sec:runtime}
\include{runtime/ocamlrun}
\include{runtime/ffi}

\chapter{GC}
\todo{Should be re-written later}
\label{sec:gc}
\include{runtime/gc}


\chapter{Object-oriented}
\include{oo/oo}

\todo{Write later}

\chapter{Language Features}
\label{sec:compl-lang-feat}

\include{lang/stream}
\include{lang/gadt}
\include{lang/module}
\include{lang/phantom}
\include{lang/posit}
\include{lang/private}
\include{lang/subtyping}
\include{lang/explicit_type}

\section{The module Language}
\label{sec:module-language}
\todo{write later}

\chapter{subtle bugs}
\label{sec:subtle-bugs}
\include{bugs/reload}
\include{bugs/mem}
\include{bugs/debug}
\include{bugs/debug_cheat_sheet}

\chapter{Interoperating With C}
\label{sec:inter-with-c}
\todo{Write later}
\include{c/M4}

\chapter{Pearls}
\include{pearl/jones}
\include{pearl/reddit}
\include{pearl/godi}

%% \chapter{Book}
%% \include{books/developing_application_with_ocaml}
%% \include{books/ocaml_for_scientists}
%% \include{books/caltech_ocaml}
%% \include{books/the_functional_approach_to_programming}
%% \include{books/practical_ocaml}
%% \include{books/hol_light}
%% \include{books/unix_system_programming_in_ocaml}
%% \include{books/practical_ocaml}

\chapter{XX}
\include{trival_tricks}
\include{blogs}
\chapter{Topics}

\include{example/unification}

\include{example/llvm}
\end{document}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "master"
%%% End: 
